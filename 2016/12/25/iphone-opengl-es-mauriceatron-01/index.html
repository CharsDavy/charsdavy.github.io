<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>西蒙 iPhone OpenGL ES 01 (构成复杂物体的基本绘图要素) - Chars&#39;s Tech Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="OpenGL（英语：Open Graphics Library，译名：开放图形库或者“开放式图形库”）是用于渲染2D、3D矢量图形的跨语言、跨平台的应用程序编程接口（API）。这个接口由近350个不同的函数调用组成，用来从简单的图形比特绘制复杂的三维景象。而另一种程序接口系统是仅用于Microsoft Windows上的Direct3D。OpenGL常用于CAD、虚拟实境、科学可视化程序和电子游戏">
<meta property="og:type" content="article">
<meta property="og:title" content="西蒙 iPhone OpenGL ES 01 (构成复杂物体的基本绘图要素)">
<meta property="og:url" content="http://charsdavy.github.io/2016/12/25/iphone-opengl-es-mauriceatron-01/index.html">
<meta property="og:site_name" content="Chars's Tech Blog">
<meta property="og:description" content="OpenGL（英语：Open Graphics Library，译名：开放图形库或者“开放式图形库”）是用于渲染2D、3D矢量图形的跨语言、跨平台的应用程序编程接口（API）。这个接口由近350个不同的函数调用组成，用来从简单的图形比特绘制复杂的三维景象。而另一种程序接口系统是仅用于Microsoft Windows上的Direct3D。OpenGL常用于CAD、虚拟实境、科学可视化程序和电子游戏">
<meta property="og:image" content="http://o88e8any8.bkt.clouddn.com/Pipeline_OpenGL.png?imageView/2/w/700">
<meta property="og:image" content="http://o88e8any8.bkt.clouddn.com/18_1030_29cb53c37d9024a.jpg">
<meta property="og:image" content="http://o88e8any8.bkt.clouddn.com/18_1030_353762606b8ab7c.png">
<meta property="og:updated_time" content="2016-12-25T12:40:25.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="西蒙 iPhone OpenGL ES 01 (构成复杂物体的基本绘图要素)">
<meta name="twitter:description" content="OpenGL（英语：Open Graphics Library，译名：开放图形库或者“开放式图形库”）是用于渲染2D、3D矢量图形的跨语言、跨平台的应用程序编程接口（API）。这个接口由近350个不同的函数调用组成，用来从简单的图形比特绘制复杂的三维景象。而另一种程序接口系统是仅用于Microsoft Windows上的Direct3D。OpenGL常用于CAD、虚拟实境、科学可视化程序和电子游戏">
<meta name="twitter:image" content="http://o88e8any8.bkt.clouddn.com/Pipeline_OpenGL.png?imageView/2/w/700">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="/webfonts/ptserif/main.css" rel='stylesheet' type='text/css'>
  <link href="/webfonts/source-code-pro/main.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-80507808-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


</head>

<body>
  <div id="container">
    <header id="header">
  <div id="header-outer" class="outer">
    <div id="header-inner" class="inner">
      <a id="main-nav-toggle" class="nav-icon" href="javascript:;"></a>
      <a id="logo" class="logo logo-text" href="/">Chars</a>
      <nav id="main-nav">
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/categories">Categories</a>
        
          <a class="main-nav-link" href="/tags">Tags</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
          <a class="main-nav-link" href="/atom.xml">Rss</a>
        
      </nav>
      <nav id="sub-nav">
        <div id="search-form-wrap">
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://charsdavy.github.io"></form>
        </div>
      </nav>
    </div>
  </div>
</header>
    <section id="main" class="outer"><article id="post-iphone-opengl-es-mauriceatron-01" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      西蒙 iPhone OpenGL ES 01 (构成复杂物体的基本绘图要素)
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2016/12/25/iphone-opengl-es-mauriceatron-01/" class="article-date">
  <time datetime="2016-12-25T10:19:30.000Z" itemprop="datePublished">2016-12-25</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS/">iOS</a>
  </div>

<!--
      
        <div class="article-comment-link-wrap">
          <a href="http://charsdavy.github.io/2016/12/25/iphone-opengl-es-mauriceatron-01/#ds-thread" class="article-comment-link">Comments</a>
        </div>
      
-->
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>OpenGL（英语：Open Graphics Library，译名：开放图形库或者“开放式图形库”）是用于渲染2D、3D矢量图形的跨语言、跨平台的应用程序编程接口（API）。这个接口由近350个不同的函数调用组成，用来从简单的图形比特绘制复杂的三维景象。而另一种程序接口系统是仅用于Microsoft Windows上的Direct3D。OpenGL常用于CAD、虚拟实境、科学可视化程序和电子游戏开发。<br>OpenGL的高效实现（利用了图形加速硬件）存在于Windows，部分UNIX平台和Mac OS。这些实现一般由显示设备厂商提供，而且非常依赖于该厂商提供的硬件。开放源代码库Mesa是一个纯基于软件的图形API，它的代码兼容于OpenGL。但是，由于许可证的原因，它只声称是一个“非常相似”的API。<br>OpenGL规范由1992年成立的OpenGL架构评审委员会（ARB）维护。ARB由一些对创建一个统一的、普遍可用的API特别感兴趣的公司组成。</p>
<p>OpenGL规范描述了绘制2D和3D图形的抽象API。尽管这些API可以完全通过软件实现，但它是为大部分或者全部使用硬件加速而设计的。<br>OpenGL的API定义了若干可被客户端程序调用的函数，以及一些具名整型常数（例如，常数GL_TEXTURE_2D对应的十进制整数为3553）。虽然这些函数的定义表面上类似于C编程语言，但它们是语言独立的。因此，OpenGL有许多语言绑定，值得一提的包括：JavaScript绑定的WebGL（基于OpenGL ES 2.0在Web浏览器中的进行3D渲染的API）；C绑定的WGL、GLX和CGL；iOS提供的C绑定；Android提供的Java和C绑定。<br>OpenGL不仅语言无关，而且平台无关。规范只字未提获得和管理OpenGL上下文相关的内容，而是将这些作为细节交给底层的窗口系统。出于同样的原因，OpenGL纯粹专注于渲染，而不提供输入、音频以及窗口相关的API。<br>OpenGL是一个不断进化的API。新版OpenGL规范会定期由Khronos Group发布，新版本通过扩展API来支持各种新功能。每个版本的细节由Khronos Group的成员一致决定，包括显卡厂商、操作系统设计人员以及类似Mozilla和谷歌的一般性技术公司。</p>
<p><img src="http://o88e8any8.bkt.clouddn.com/Pipeline_OpenGL.png?imageView/2/w/700" alt=""></p>
<a id="more"></a>
<p><strong>图元</strong> 是构成复杂物体的基本绘图要素。在OpenGL ES中，你可以使用的图元有点，线，三角形。它们都有非常强的自我解释性，我觉得你需要有些例子让你看到它们。</p>
<p>首先，让我们来看看一些代码，然后我们可以谈论这是怎么回事，这样您就可以使用它来创建一些自己的代码。</p>
<p>三角形是最“复杂”的图元，但是很容易使用，并且非常实用,这将是你可以绘制的第一个OpenGL的图元。当我们绘制一个三角形的时候，我们需要告诉OpenGL在3d空间中的三角形的3系坐标，并且，OpenGL将非常顺利的渲染这个三角形。</p>
<p>在开始之前，复制00教程中的项目代码或者从这里下载下项目代码： AppleCoder-OpenGLES-00.tar.gz .在XCode中打开，开启EAGLView.m文件，找到drawView函数。这里就是施展魔法的地方。</p>
<p>首先，我们需要定义一个三角形。要做到这点，我们需要知道在我们要处理的坐标的两种类型：模型和世界。模型坐标是指我们正在绘制的实际图元，世界坐标告诉OpenGL观察者在哪里。（在世界坐标中，观察者一般在（0.0,0.0,0.0）的地方）</p>
<p>第一个例子将说明这点。首先，我们定义这个三角形在模型空间使用3 x 3d 坐标（x,y,z）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">const GLfloat triangleVertices[] = &#123;</span><br><span class="line">        0.0, 1.0, -6.0,// Triangle top centre</span><br><span class="line">        -1.0, -1.0, -6.0,// bottom left</span><br><span class="line">        1.0, -1.0, -6.0,// bottom right</span><br><span class="line">    &#125;;</span><br></pre></td></tr></table></figure>
<p>如上所示，这里使用了3个坐标来表示一个三角形，需要注意的是，我们定义三角形顶点是逆时针来显示的。虽然描述三角形的可以用逆时针也可以用顺时针，但是我们必须和上述一样用逆时针来描述三角形。不过，我建议你用逆时针来描述三角形，因为我们以后可以用逆三角形来达到一些先进的功能。<br>（补充：逆三角形在3d中被认为是正面，而顺三角形则被认为是反面。在纹理渲染中被使用到）</p>
<p>虽然本教程应该是纯粹的iPhone OpenGL ES的，对于初学者来说，我会简要的描述三维坐标系统。看看这张图片：</p>
<p><img src="http://o88e8any8.bkt.clouddn.com/18_1030_29cb53c37d9024a.jpg" alt=""></p>
<p>对于我的绘画技巧，我深表遗憾。不过这个图代表了模型空间和世界空间。 试想一下，这是您的计算机屏幕， X和Y的横向和纵向的，你应该预料到， Z表示深入。这个中心位置就是(0.0,0.0,0.0).</p>
<p>所以，看我们的三角形中所描述的顶点上述情况，第一点（ 0.0 ， 1.0 ， -6.0 ）中心将在的Y轴，上涨1点，在屏幕的深度为6点。 第二个坐标是右边的Y轴1.0点，低于X轴（因此-1.0的Y值） ，仍然回到屏幕-6.0点。这同样适用于第三个坐标。</p>
<p>为此，我们确定目标在我们眼睛之前(z值是负的),所以这个目标是可见的（记得吗，观察者或者说照相机是在（0.0，0.0，0.0）的位置上）所以说OpenGL的深度测试是失败的并且它没有被渲染。</p>
<p>我可以听到你尖叫“嘿，我还以为你说，这是模型坐标不是世界坐标！ ” 。 是的，这是对的，但是，当我们去渲染这个三角形之前， OpenGL的将只是把对象放在（ 0.0 ， 0.0 ， 0.0 ） 的位置上。 因此，我们将它放到屏幕内才可见。 当我们进入转换（移动，旋转等） ，您会看到，您将不必设置对象Z值为负，也可以使之可见。在此之前，让目标的Z坐标在-6.0的位置上。</p>
<h2 id="绘制函数"><a href="#绘制函数" class="headerlink" title="绘制函数"></a>绘制函数</h2><p>所以我们这样做是为了说明目前的三角形。我们现在需要告诉OpenGL，数据保存在哪里，以及如何去绘制它。这个过程只需要很少的几行代码。回到drawView函数，并且实行以下的代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">- (void)drawView &#123;</span><br><span class="line">	const GLfloat triangleVertices[] = &#123;</span><br><span class="line">        0.0, 1.0, -6.0, // Triangle top centre</span><br><span class="line">        -1.0, -1.0, -6.0, // bottom left</span><br><span class="line">        1.0, -1.0, -6.0   // bottom right</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    [EAGLContext setCurrentContext:context];</span><br><span class="line">    glBindFramebufferOES(GL_FRAMEBUFFER_OES, viewFramebuffer);</span><br><span class="line">    glViewport(0, 0, backingWidth, backingHeight);</span><br><span class="line"></span><br><span class="line">// -- BEGIN NEW CODE</span><br><span class="line"></span><br><span class="line">	glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);</span><br><span class="line"></span><br><span class="line">	glVertexPointer(3, GL_FLOAT, 0, triangleVertices);</span><br><span class="line">	glEnableClientState(GL_VERTEX_ARRAY);</span><br><span class="line">	glDrawArrays(GL_TRIANGLES, 0, 3);</span><br><span class="line"></span><br><span class="line">// -- END NEW CODE</span><br><span class="line"></span><br><span class="line">    glBindRenderbufferOES(GL_RENDERBUFFER_OES, viewRenderbuffer);</span><br><span class="line">    [context presentRenderbuffer:GL_RENDERBUFFER_OES];</span><br><span class="line"></span><br><span class="line">	[self checkGLError:NO];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如你所见，这4行代码就是我们渲染一个三角形的。让我们从上往下一行行的打断这些代码来分析，你会发现它们是非常的简单。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);</span><br></pre></td></tr></table></figure>
<p>这行代码只是简单的清除了屏幕。这个控制位告诉OpenGL，我们使用上次教程里面setupView函数中设置的颜色（黑色）来清除屏幕，并且清除了深度缓冲。 请注意，如果我们没有创建深度缓冲和开启深度缓冲（如我们应该做的）,这个屏幕将不会渲染。如果我们不使用深度缓冲，我们将不需要通过glClear()里的 GL_DEPTH_BUFFER_BIT.</p>
<p>因此，我们无论是清除以前绘制的这个缓冲区（请记住，这是双重缓冲动画;利用一个缓冲区而另一个缓冲区显示） 。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">glVertexPointer(3, GL_FLOAT, 0, triangleVertices);</span><br></pre></td></tr></table></figure>
<p>此函数告诉OpenGL的情况下我们的数据是什么格式，它是有4个参数，这个功能是很简单细分：</p>
<p>1.Size-这个值表示了每个坐标有几个数字。我们现在是3，是因为是3d坐标(x,y,z).如果我们使用2d绘制，不加入深度(就是z),我们只要在这里写2就可以了。</p>
<p>2.Data Type- GL_FLOAT 意味着我们用float点值。 您也可以使用整数值，但如果你想你需要习惯于使用浮点值的3D世界的浮点运算。</p>
<p>3.Stride -  这个stride告诉OpenGL 在每个坐标之间忽略哪几个点。别对这个表示疑惑，保持它是0就行了。你使用它<br>当您载入顶点数据文件的格式有更多的填充数据或肤色的数据，也就是说，一个3D程序像搅拌机。</p>
<p>4.Pointer to the Data – 数据本身，正是因为它，三角形才会出现。</p>
<p>因此，我们告诉OpenGL清除缓冲区，告诉它的数据是我们的目标和它的格式，现在我们需要告诉OpenGL的东西很重要：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">glEnableClientState(GL_VERTEX_ARRAY);</span><br></pre></td></tr></table></figure>
<p>OpenGL是一个状态机。 这意味着你打开和关闭功能的要求就是启用和禁用命令。之前，我们使用过glEnable()，这影响到OpenGL的服务。 glEnableClientState ()影响到我们的程序方面（就是客户端面）。所以我们要做的就是告诉OpenGL我们顶点数据是一个顶点数组并且转换到OpenGL的绘制顶点功能。在这个情况下，顶点可以是一个颜色数组，我们将呼叫 glEnableClientState (GL_COLOR_ARRAY)或者一个纹理坐标数组如同纹理映射。(别垂涎三尺，你需要掌握所有的基本知识包括纹理映射)</p>
<p>随着我们进一步的研究OpenGL ，我们会使用不同的客户端状态，这将使用变得更为清晰。</p>
<p>现在命令OpenGL渲染一个三角形。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">glDrawArrays(GL_TRIANGLES, 0, 3);</span><br></pre></td></tr></table></figure>
<p>一旦这个方法被调用，OpenGL将用我们之前的两个函数的信息开始执行。屏幕中间出现一个白色的实心的三角形（白色是默认的绘制颜色）。现在的三角形是一个实心的，如果你需要一个镂空的三角形，你将要用不同的绘制方法。</p>
<p>分析这个方法里的三个参数：</p>
<p>1.Drawing Method- 在这种情况下，我们已通过GL_TRIANGLES这似乎相当明显，因为我们画一个三角形。然而，这一方法的第一个参数将变得很明显，当我们使用此功能，来绘制一个平面体。</p>
<p>2.First Vertex- 我们阵列只有3点，所以我们想要的OpenGL提请第一坐标的数组，这里指定零就像进入一个标准数组。 如果我们有多种原始的顶点数组，我们可以在这里处理。我会在以后的教程教你，当我告诉您该如何建立复杂的物体的时候。现在，这里只要使用0。</p>
<p>3.Vertex Count-这将告诉OpenGL在我们的数组中有多少顶点需要被绘制。比如说，我们绘制一个三角形，所以至少要3点，一个平方形需要4点，一个线需要2点（或更多），一个点需要一个（或者多点）</p>
<p>当你把这些代码都输入到你的drawView函数里面以后。点击“Build and Go”运行这个程序在模拟器里面。你的模拟器应该看起来象如下的图：</p>
<p><img src="http://o88e8any8.bkt.clouddn.com/18_1030_353762606b8ab7c.png" alt=""></p>
<p>如我们所说的，有一个实心的白色的三角形出现在屏幕的中间。</p>
<p>在我们做其他的图元之前，尝试修改z值，你就会明白我所说的是什么意思。如果你把z改为0，你将什么也看不到。</p>
<p>如果你自己输入几行代码，我希望你可以来发现OpenGL ES 是如何工作的。如果你学习过“标准”的OpenGL的教程，我希望你可以发现OpenGL与OpenGL ES的不同。</p>
<p><a href="https://github.com/charsdavy/iPhone-OpenGL-ES-Tutorial-Series">iPhone-OpenGL-ES-Tutorial-Series Demo</a></p>
<p>原文地址：<a href="http://www.cocoachina.com/bbs/read.php?tid-5506-fpage-10.html">http://www.cocoachina.com/bbs/read.php?tid-5506-fpage-10.html</a></p>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/openGL/">OpenGL</a></li></ul>

      </footer>
    
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2016/12/30/opengl-es-2-ios-primary/" id="article-nav-newer" class="article-nav-link-wrap">
      <div class="article-nav-title"><span>&lt;</span>&nbsp;
        
          OpenGL ES 2.0 iOS 入门篇
        
      </div>
    </a>
  
  
    <a href="/2016/11/15/apple-app-release-analysis/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">iOS App 上架（Analysis 工具使用）&nbsp;<span>&gt;</span></div>
    </a>
  
</nav>

  
</article>




<div class="share_addthis">
  <div class="sharing addthis_toolbox share">
    <a class="addthis_button_facebook_like"></a>
    <a class="addthis_button_tweet"></a>
    <a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
    <a class="addthis_counter addthis_pill_style"></a>
  </div>
  <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-560c64c35486b3d4" async="async"></script>
</div>






<section id="comments">
  <!-- 多说评论框 start -->
  <div class="ds-thread" data-thread-key="post-iphone-opengl-es-mauriceatron-01" data-title="西蒙 iPhone OpenGL ES 01 (构成复杂物体的基本绘图要素)" data-url="http://charsdavy.github.io/2016/12/25/iphone-opengl-es-mauriceatron-01/"></div>
  <!-- 多说评论框 end -->
  <!-- 多说公共JS代码 start (一个网页只需插入一次) -->
  <script type="text/javascript">
  var duoshuoQuery = {short_name:'charsdavy'};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0] 
       || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
    </script>
  <!-- 多说公共JS代码 end -->
</section>
</section>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 Chars Davy&nbsp;
     </div>
  </div>
</footer>

    

<script src="/js/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

<div id="totop" style="position:fixed;bottom:30px;right:30px;cursor: pointer;">
<a title="返回顶部"><img src="/img/scrollup.png"/></a>
</div>
<script src="/js/totop.js"></script>

  </div>
</body>
</html>